import{b as k}from"./metadata.DZbmnv7Q.js";import{u as w}from"./index.DdrW3HGD.js";import{u as y}from"./index.BT3uaeP2.js";import{u as P}from"./index.oqMf4-M6.js";import{r as q,A as n,z as E}from"./vue.CKrRORKQ.js";function x(d={}){const{navigator:t=k,requestPermissions:f=!1,constraints:c={audio:!0,video:!0},onUpdated:r}=d,i=q([]),m=n(()=>i.value.filter(e=>e.kind==="videoinput")),p=n(()=>i.value.filter(e=>e.kind==="audioinput")),D=n(()=>i.value.filter(e=>e.kind==="audiooutput")),u=P(()=>t&&t.mediaDevices&&t.mediaDevices.enumerateDevices),a=E(!1);let s;async function o(){u.value&&(i.value=await t.mediaDevices.enumerateDevices(),r==null||r(i.value),s&&(s.getTracks().forEach(e=>e.stop()),s=null))}async function v(){const e=c.video?"camera":"microphone";if(!u.value)return!1;if(a.value)return!0;const{state:g,query:h}=y(e,{controls:!0});if(await h(),g.value!=="granted"){let l=!0;try{s=await t.mediaDevices.getUserMedia(c)}catch{s=null,l=!1}o(),a.value=l}else a.value=!0;return a.value}return u.value&&(f&&v(),w(t.mediaDevices,"devicechange",o,{passive:!0}),o()),{devices:i,ensurePermissions:v,permissionGranted:a,videoInputs:m,audioInputs:p,audioOutputs:D,isSupported:u}}export{x as u};
