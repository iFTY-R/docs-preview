import{t as M}from"./index.xAcUqA8Y.js";import{w as W}from"./index.ChIAw1Ez.js";import{d as v}from"./metadata.DZbmnv7Q.js";import{u as O}from"./index.DdrW3HGD.js";import{z as F,r as x,A as H,a1 as E,B as R,v as B}from"./vue.CKrRORKQ.js";const d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},p="__vueuse_ssr_handlers__",K=L();function L(){return p in d||(d[p]=d[p]||{}),d[p]}function P(e,u){return K[e]||u}function q(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const G={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},A="vueuse-storage";function Z(e,u,a,g={}){const{flush:w="pre",deep:_=!0,listenToStorageChanges:z=!0,writeDefaults:J=!0,mergeDefaults:m=!1,shallow:k,window:l=v,eventFilter:D,onError:y=t=>{console.error(t)},initOnMounted:S}=g,o=(k?F:x)(typeof u=="function"?u():u),i=H(()=>E(e));if(!a)try{a=P("getDefaultStorage",()=>{var t;return(t=v)==null?void 0:t.localStorage})()}catch(t){y(t)}if(!a)return o;const s=E(u),b=q(s),f=g.serializer??G[b],{pause:T,resume:h}=W(o,()=>V(o.value),{flush:w,deep:_,eventFilter:D});R(i,()=>c(),{flush:w}),l&&z&&M(()=>{a instanceof Storage?O(l,"storage",c,{passive:!0}):O(l,A,C),S&&c()}),S||c();function N(t,r){if(l){const n={key:i.value,oldValue:t,newValue:r,storageArea:a};l.dispatchEvent(a instanceof Storage?new StorageEvent("storage",n):new CustomEvent(A,{detail:n}))}}function V(t){try{const r=a.getItem(i.value);if(t==null)N(r,null),a.removeItem(i.value);else{const n=f.write(t);r!==n&&(a.setItem(i.value,n),N(r,n))}}catch(r){y(r)}}function j(t){const r=t?t.newValue:a.getItem(i.value);if(r==null)return J&&s!=null&&a.setItem(i.value,f.write(s)),s;if(!t&&m){const n=f.read(r);return typeof m=="function"?m(n,s):b==="object"&&!Array.isArray(n)?{...s,...n}:n}else return typeof r!="string"?r:f.read(r)}function c(t){if(!(t&&t.storageArea!==a)){if(t&&t.key==null){o.value=s;return}if(!(t&&t.key!==i.value)){T();try{(t==null?void 0:t.newValue)!==f.write(o.value)&&(o.value=j(t))}catch(r){y(r)}finally{t?B(h):h()}}}}function C(t){c(t.detail)}return o}export{P as g,Z as u};
